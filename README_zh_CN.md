# Siyuan Code Tabs

[English](./README.md)

一个用于思源笔记的代码标签页插件，让多语言代码以标签页形式更清晰地组织与展示。

## 功能特性

- 多语言代码标签页展示，支持快捷编辑
- 标签页编辑面板：新增、删除、改名、改语言、改代码
- 支持设置默认标签与一键复制当前标签代码
- 批量操作：合并多个代码块、拆分标签页为代码块（块级/文档级/全局）
- 主题样式自定义与适配能力

## 兼容性

- **仅支持思源 3.5.0 及以上版本**
- 需要开启：设置 -> 编辑器 -> `允许执行HTML块内脚本`

## 快速开始

1. 通过斜杠菜单输入 `标签页` / `tab` / `bq` 插入默认标签页
2. 或选中多个代码块，通过块菜单 `块：合并选中代码块` 生成标签页
3. 点击标签页右上角 **编辑** 按钮打开编辑面板

## 使用说明

1. **编辑标签页**
   - 修改标题、语言、代码内容
   - 支持新增/删除标签
   - 语言为 `markdown-render` 时，使用思源内置 Lute 渲染，支持 KaTeX / Mermaid / Graphviz / PlantUML / ABC
2. **设为默认**
   - 点击右上角 **设为默认** 按钮，将当前标签设为默认展示
3. **复制**
   - 点击右上角 **复制** 按钮，一键复制当前标签代码
4. **更多操作（块菜单）**
   - `块：合并选中代码块`
   - `块：拆分标签页为代码块`
   - `文档：拆分标签页为代码块`
5. **设置面板（全局入口）**
   - `将所有代码标签页拆分为代码块`（用于弃用插件时方便还原）
   - `迁移旧标签页`（将旧版本标签页升级为新版本）

## 主题适配

- 若主题样式异常，可尝试：
  - 切换外观模式 / 主题
  - 关闭文档再重开
  - 重启思源
- 可通过自定义配置适配主题：
  - 路径：`SiYuan工作空间/data/plugins/code-tabs/custom/theme-adaption.yaml`
  - 仓库内参考：`/public/asset/theme-adaption.yaml`

## 数据说明

- 标签页原始数据以 Base64 形式存储在块自定义属性中
- 只要自定义属性未丢失，数据可恢复

## 已知问题

- 不保证适配所有第三方主题
- 导出为 markdown / HTML 时样式会丢失
- 仅导出 PDF/图片时可显示标签页样式，但无法切换标签

## 演示

![斜杠菜单](./images/demo_slash.png)

![预览](./images/demo_preview.png)

![编辑](./images/demo_edit.png)

## 备注

- 插件开发过程中使用了 AI 辅助
- 参考项目：[obsidian-code-tab](https://github.com/lazyloong/obsidian-code-tab)
- 测试思源版本：3.5.3

## 更新日志

### v2.0.2

- 修复移动端点击标签/打开编辑面板时输入法误触发的问题
- 修复移动端语言联想列表点击无响应的问题
- 修复命令在终端中显示为 undefine 的问题
- 块菜单新增图标

### v2.0.1

- 修复块菜单在选区内操作时误选中全局标签页的问题

### v2.0.0

- 全新升级：不再使用代码块作为中转
- 新增编辑面板，支持直接新增与删除标签页

更多历史版本请查看 [CHANGELOG.md](CHANGELOG.md)。
